<!DOCTYPE html>
<html lang="ko">
    <head>
        <meta charset="UTF-8" />
        <meta http-equiv="X-UA-Compatible" content="IE=edge" />
        <meta name="viewport" content="width=device-width, initial-scale=1.0" />
        <title>3장 함수</title>
        <meta name="description" content="<!-- title: 3장 함수 author: Gaeun Lee date: 2022-04-02 --> 3장 함수 어떤 프로그램이든 가장 기본적인 단위가 함수다. 이 장은 함수에 어떤 속성을 부여해야 처음 읽는 사람이 프로그램 내부를 직관적으로 파악할 수 있는지, 더욱 읽기 쉽고 이해하기 쉬운지, 의도를 분명히 표현하는 함수를 구현할 수 있는 지에 대해 소개" />
        <link rel="preconnect" async href="https://fonts.googleapis.com" />
        <link
            rel="preconnect"
            async
            href="https://fonts.gstatic.com"
            crossorigin
        />
        <link
            async
            href="https://fonts.googleapis.com/css2?family=Anonymous+Pro:ital@0;1&family=Nanum+Gothic+Coding&family=Noto+Sans+KR:wght@400;700&display=swap"
            rel="stylesheet"
        />
        <link rel="stylesheet" async href="/Clean-Code/css/reset.css" />
        <link rel="stylesheet" async href="/Clean-Code/css/icon.css" />
        <link rel="stylesheet" async href="/Clean-Code/css/style.css" />
        <style>
            @font-face {
                font-family: icon;
                src: url("/Clean-Code/icon/icon.woff?zg8y3j") format("woff"),
                    url("/Clean-Code/icon/icon.svg?zg8y3j#icon") format("svg");
                font-weight: 400;
                font-style: normal;
                font-display: block;
            }
        </style>
    </head>
    <body>
        <div class="masthead">
            <div class="masthead__inner">
                <div class="masthead__grow masthead__left">
                    <button
                        class="drawer-opener icon-menu"
                        aria-label="메뉴 보기"
                    ></button>
                </div>
                <div class="masthead__center">3장 함수</div>
                <div class="masthead__grow masthead__right">
                    <button
                        class="toc-opener icon-bookmark_outline"
                        aria-label="목차 보기"
                    ></button>
                </div>
            </div>
        </div>
        <nav class="global-navigation">
            <div class="global-navigation__content">
                <ul><li><a href="/Clean-Code/">클린 코드 스터디</a></li><li><a href="/Clean-Code/1%EC%9E%A5%20-%20%EA%B9%A8%EB%81%97%ED%95%9C%20%EC%BD%94%EB%93%9C/">1장 - 깨끗한 코드</a></li$><li><a href="/Clean-Code/2%EC%9E%A5%20-%20%EC%9D%98%EB%AF%B8%20%EC%9E%88%EB%8A%94%20%EC%9D%B4%EB%A6%84/">2장 - 의미 있는 이름</a></li$><li class="highlight"><a href="/Clean-Code/3%EC%9E%A5%20-%20%ED%95%A8%EC%88%98/">3장 - 함수</a></li$><li><a href="/Clean-Code/9%EC%9E%A5%20-%20%EB%8B%A8%EC%9C%84%20%ED%85%8C%EC%8A%A4%ED%8A%B8/">9장 - 단위 테스트</a></li$></ul>
            </div>
        </nav>
        <main>
            <article class="article">
                <!--
title: 3장 함수
author: Gaeun Lee
date: 2022-04-02
-->
<h1 id="3장-함수">3장 함수</h1>
<p>어떤 프로그램이든 가장 기본적인 단위가 함수다. 이 장은 함수에 어떤 속성을 부여해야 처음 읽는 사람이 프로그램 내부를 직관적으로 파악할 수 있는지, 더욱 읽기 쉽고 이해하기 쉬운지, 의도를 분명히 표현하는 함수를 구현할 수 있는 지에 대해 소개한다.</p><h2 id="작게-만들어라">작게 만들어라</h2>
<ul>
<li>함수를 만드는 첫째 규칙은 <code>작게</code>, 둘째 규칙은 <code>더 작게</code></li>
<li>얼마나 짧아야 좋을까? 이 정도가 좋다.</li>
</ul>
<pre><code class="language-js">function renderPageWithSetupsAndTeardown(pageData, isSuite) {
    if (isTestPage(pageDate)) includeSetupAndTeardownPages(pageData, isSuite);
    return pageData.getHtml();
}
</code></pre>
<h3 id="블록과-들여쓰기">블록과 들여쓰기</h3>
<ul>
<li>중첩 블록(if/else문, while문)은 한 줄이어야 하고, 대게 거기서 함수를 호출한다.</li>
<li>함수에서 들여쓰기 수준은 <strong>1단</strong>이나 <strong>2단</strong>을 넘으면 안 된다. 그래야 함수를 읽고 이해하기 쉬워진다.</li>
</ul>
<h2 id="한-가지만-해라">한 가지만 해라</h2>
<blockquote>
<p>함수는 한 가지를 해야 한다. 그 한가지를 잘 해야 한다. 그 한 가지만을 해야 한다.</p>
</blockquote>
<p><code>한가지</code>란? 지정된 함수 이름 아래에서 추상화 수준이 하나인 단계만 수행하는 것</p>
<h3 id="함수-내-섹션">함수 내 섹션</h3>
<p>한 함수를 여러 섹션으로 나눌 수 있다면 여러 작업을 한다는 것이다.<br>
한 가지 작업만 하는 함수는 자연스럽게 섹션으로 나누기 어렵다.</p>
<h2 id="함수-당-추상화-수준은-하나로">함수 당 추상화 수준은 하나로</h2>
<ul>
<li>함수가 확실히 <code>한 가지</code> 작업만 하려면 함수 내 모든 문장의 <strong>추상화 수준이 동일</strong>해야 한다.</li>
<li>한 함수 내에 추상화 수준을 섞으면 읽는 사람이 헷갈린다.</li>
</ul>
<h3 id="위에서-아래로-코드-읽기-내려가기-규칙">위에서 아래로 코드 읽기: 내려가기 규칙</h3>
<ul>
<li>위에서 아래로 이야기처럼 읽히는 코드</li>
<li>함수 추상화 수준이 한 번에 한 단계씩 낮아진다.</li>
</ul>
<h2 id="switch문">Switch문</h2>
<p>switch문은 본질적으로 N가지를 처리한다. 불행히도 switch문을 완전히 피할 순 없으나, interface나 abstract factory 등 상속 관계로 숨기고 다른 코드에 노출하지 않는다.</p>
<pre><code class="language-js">function calculatePay(employee) {
    switch (employee.type) {
        case COMMISSIONED:
            return calculateCommissionedPay(employee);
        case COMMISSIONED:
            return calculateHourlyPay(employee);
        case COMMISSIONED:
            return calculateSalariedPay(employee);
        default:
            throw new InvalidEmployeeType(employee.type);
    }
}
</code></pre>
<p>하지만 불가피하게 switch를 사용할 수 밖에 없는 상황도 생기므로 상황에 따라 사용한다.</p>
<h2 id="서술적인-이름을-사용하라">서술적인 이름을 사용하라</h2>
<ul>
<li>길고 서술적인 이름이 짧고 어려운 이름보다, 긴 주석보다 좋다.</li>
<li>tips
<ul>
<li>함수 이름은 여러 단어가 쉽게 읽히는 명명법을 사용한다.</li>
<li>그 다음 가장 여러 단어를 사용해 함수의 기능을 더 잘 표현하는 이름을 선택한다.</li>
<li>비슷한 문체 사용 (같은 문구, 명사, 동사를 사용하는 일관성)</li>
</ul>
</li>
<li>서술적인 이름을 사용하면 개발자 머릿속에서도 설계가 뚜렷해지므로 코드를 개선하기 쉬워진다.</li>
</ul>
<h2 id="함수-인수">함수 인수</h2>
<ul>
<li>이상적인 인수 개수는 0개(무항)이고, 차선은 입력 인수가 1개인 경우다. 가능하면 삼항은 피하고, 4개 이상(다항)은 특별한 이유가 필요하다.</li>
<li>인수가 많아지면 코드를 이해하기에도 더 어렵고 테스트 관점에서도 부담스럽다.</li>
</ul>
<h3 id="많이-쓰는-단항-형식">많이 쓰는 단항 형식</h3>
<ul>
<li>인수에 질문을 던지는 경우
<code>fileExists('myFile')</code></li>
<li>인수를 뭔가로 변환해 결과를 반환하는 경우
<code>fileOpen('myFile')</code></li>
<li>이벤트를 사용하는 경우 이벤트라는 사실이 코드에 명확이 드러나야 한다.</li>
</ul>
<h3 id="플래그flag-인수">플래그(flag) 인수</h3>
<ul>
<li>플래그 인수는 추하다. 함수로 boolean을 넘기는 것 자체가 함수가 여러 가지를 처리 한다고 대놓고 공표하는 셈이다.</li>
</ul>
<h3 id="이항-함수">이항 함수</h3>
<ul>
<li><code>writeField(name)</code>이 <code>writeField(outputStream, name)</code>보다 이해하기 쉽다.</li>
<li>이항 함수가 적절한 경우
<ul>
<li>인수 2개가 한 값을 표현하는 요소인 경우 (자연적인 순서가 있다)</li>
<li><code>Point p = new Point(0,0)</code></li>
</ul>
</li>
<li>이항 함수는 위험이 따른다는 사실을 이해하고 가능하면 단항 함수로 바꾸도록 애써야 한다.</li>
</ul>
<h3 id="삼항-함수">삼항 함수</h3>
<ul>
<li>이항함수보다 훨씬 더 이해하기 어렵고, 무시로 야기되는 문제가 두 배 이상 늘어나므로 신중이 사용을 고려해야 한다.</li>
<li><code>assertEquals(message, expected, actual)</code>의 경우 첫 번째 인수를 무시해야 한다.</li>
</ul>
<h3 id="인수-객체">인수 객체</h3>
<ul>
<li>인수가 2~3개 필요하다면 인수 일부를 독자적인 클래스 변수로 선언한 가능성을 살펴보자. (?)</li>
</ul>
<h3 id="인수-목록">인수 목록</h3>
<ul>
<li>때로는 인수 개수가 가변적인 함수도 필요하다. 가변 인수 전부를 동등하게 취급하면 List형 인수 하나로 취급할 수 있다.</li>
</ul>
<h3 id="동사와-키워드">동사와 키워드</h3>
<ul>
<li>단항 함수는 함수와 인수가 동사/명사 쌍을 이뤄야 한다.
<ul>
<li>ex) <code>writeField(name)</code></li>
</ul>
</li>
<li>함수 이름에 키워드를 추가한다
<ul>
<li><code>assertEquals</code>보다 <code>assertExpectedEqualsActual(expected, actual)</code>이 좋다.</li>
<li>이러면 인수 순서를 기억할 필요가 없어진다.</li>
</ul>
</li>
</ul>
<h2 id="부수-효과를-일으키지-마라">부수 효과를 일으키지 마라</h2>
<ul>
<li>부수효과는 때로는 예상치 못하게 지역/전역변수 및 인수를 수정한다. 많은 경우 시간적 결합이나 순서 종속성을 초래한다.</li>
</ul>
<pre><code class="language-js">function userValidator() {
    let cryptographer;

    function checkPassword(userName, password) {
        const user = UserGateWay.findByName(userName);
        if (user !== User.NULL) {
            const codePhrase = user.getPhraseEncodedByPassword();
            const phrase = cryptographer.decrypt(codePhrase, password);
            if ("Valid Password" === phrase) {
                Session.initialize();
                return true;
            }
        }
        return false;
    }
}
</code></pre>
<p>위의 코드에서 부수효과는 <code>Session.initialize()</code>이다. 이름만 봐서는 함수 내부에서 세션을 초기화한다는 것을 알 수 없으므로, 이름만 보고 함수를 호출하면 기존의 세션 정보를 지워버릴 위험에 처한다.</p>
<p>이런 부수 효과가 시간적 결합을 초래한다. 즉, <code>checkPassword</code>는 세션을 초기화해도 괜찮은 경우에만 호출이 가능하다. 만약 시간적 결합이 필요하다면 함수 <code>checkPasswordAndInitializeSession</code>으로 이름에 분명이 명시한다.</p>
<h3 id="출력-인수">출력 인수</h3>
<ul>
<li>일반적으로 출력 인수는 피해야한다.</li>
<li>함수에서 상태를 변경해야 한다면 함수가 속한 객체 상태를 변경하는 방식을 택한다.</li>
</ul>
<h2 id="명령과-조회를-분리하라">명령과 조회를 분리하라</h2>
<ul>
<li>함수는 <strong>뭔가를 수행하거나</strong>(ex. 객체 상태를 변경) <strong>답하거나</strong>(ex. 객체 정보를 반환) 둘 중 하나만 해야한다.</li>
</ul>
<pre><code class="language-js">if (set('username', 'unclebob'))
</code></pre>
<p>개발자는 <code>set</code>을 동사로 의도했지만 if문에 넣고 보면 형용사로 <strong>느껴진다.</strong> 해결책은 명령과 조회를 분리해 혼란을 애초에 뿌리뽑는 것이다.</p>
<pre><code class="language-js">if (attributeExists("username")) {
    setAttribute("username", "unclebob");
}
</code></pre>
<h2 id="오류-코드보다-예외를-사용하라">오류 코드보다 예외를 사용하라</h2>
<p>오류 코드 대신 예외를 사용하면 오류 처리 코드가 원래 코드에서 분리되므로 코드가 깔끔해진다.</p>
<h3 id="trycatch-블록-뽑아내기">Try/Catch 블록 뽑아내기</h3>
<pre><code class="language-js">if (deletePage(page) === E_OK) {
    if (registry.deleteReference(page.name === E_OK)) {
        if (configKeys.deleteKey(page.name.makeKey() === E_OK)) {
            logger.log("page deleted");
        } else {
            logger.log("configKey not deleted");
        }
    } else {
        logger.log("deleteReference from registry failed");
    }
} else {
    logger.log("delete failed");
    return E_ERROR;
}
</code></pre>
<p>위의 코드에서 정상 동작과 오류 처리 동작을 분리하면 코드를 이해하고 수정하기 쉬워진다.</p>
<pre><code class="language-js">function deletePage(page) {
    try {
        deletePageAndAllReferences(page);
    } catch (e) {
        logError(e);
    }
}
function deletePageAndAllReferences(page) {
    deletePage(page);
    registry.deleteReference(page.name);
    configKeys.deleteKey(page.name.makeKye());
}
function logError(e) {
    logger.log(e.getMessage());
}
</code></pre>
<h3 id="오류-처리도-한-가지-작업이다">오류 처리도 한 가지 작업이다</h3>
<ul>
<li>오류를 처리하는 함수는 <strong>오류만 처리</strong>해야 한다. 함수에 키워드 <code>try</code>가 있다면 함수는 <code>catch</code>/<code>finally</code>문으로 끝나야 한다.</li>
<li>오류 코드를 반한환다는 이야기는 어디선가 오류 코드를 정의한다는 뜻이다. 이는 <code>의존성 자석</code>이다. Error enum이 변하면 이것을 사용하는 클래스나 함수를 전부 재컴파일, 재배치해야 한다.</li>
</ul>
<pre><code class="language-js">enum Error {
    OK,
    INVALID,
    NO_SUCH,
    LOCKED,
    OUT_OF_RESOURCES,
    WAITING_FOR_DEVENT
}
</code></pre>
<ul>
<li>오류 코드 대신 예외를 사용하는 것이 더 좋다.</li>
</ul>
<h2 id="반복하지-마라">반복하지 마라</h2>
<ul>
<li>중복이 많아지면 오류가 발생할 확률도 많아진다. 소스코드에서 중복을 제거하려 노력해야 한다.</li>
</ul>
<h2 id="구조적-프로그래밍">구조적 프로그래밍</h2>
<ul>
<li><code>Dijkstra 구조적 프로그래밍 원칙</code>: 모든 함수 내 모든 블록에 입구와 출구가 하나만 존재해야 한다.</li>
<li>함수는 return문이 하나여야 한다. 함수를 작게 만든다면 return, break, continue를 여러 차례 사용해도 괜찮다.</li>
<li><strong>절대 goto를 사용해서는 안된다.</strong></li>
</ul>
<h2 id="함수를-어떻게-짜죠">함수를 어떻게 짜죠?</h2>
<ul>
<li>먼저 생각을 기록한 후 읽기 좋게 다듬는다.</li>
<li>처음에는 길고 복잡하고, 들여쓰기 단계나 중복된 루프도 많다. 이름은 즉흥적이고 코드는 중복된다.</li>
<li>그런 다음 단위 테스트 케이스를 만들고, 코드를 다듬고, 함수를 바꾸고, 이름을 바꾸고, 중복을 제거하고, 메서드를 줄이고 순서를 바꾼다.</li>
<li>처음부터 함수를 잘 짜내는 것은 불가능하다.</li>
</ul>
<h2 id="결론">결론</h2>
<p>대게 프로그래머는 시스템을 (구현할) 프로그램이 아니라 (풀어갈) <strong>이야기</strong>로 여긴다. 프로그래밍 언어라는 수단을 사용해 좀 <strong>더 풍부하고 좀 더 표현력이 강한 언어</strong>를 만들어 이야기를 풀어간다. 시스템에서 발생하는 모든 동작을 설명하는 <strong>함수 계층이 바로 그 언어</strong>에 속한다.</p><div class="navigation"><article class="navigation-item navigation-item--previous"><a href="/Clean-Code/2장 - 의미 있는 이름/"><div><div class="navigation-item__type">Previous</div><h2 class="navigation-item__title">2장 - 의미 있는 이름</h2></div><div><i class="icon-arrow_back"></i></div></a></article><article class="navigation-item navigation-item--next"><a href="/Clean-Code/9장 - 단위 테스트/"><div><div class="navigation-item__type">Next</div><h2 class="navigation-item__title">9장 - 단위 테스트</h2></div><div><i class="icon-arrow_forward"></i></div></a></article></div>
            </article>
            <div class="toc-container"><ul class="toc"><li><p><a href="#%EC%9E%91%EA%B2%8C-%EB%A7%8C%EB%93%A4%EC%96%B4%EB%9D%BC">작게 만들어라</a></p><ul><li><a href="#%EB%B8%94%EB%A1%9D%EA%B3%BC-%EB%93%A4%EC%97%AC%EC%93%B0%EA%B8%B0">블록과 들여쓰기</a></li></ul></li><li><p><a href="#%ED%95%9C-%EA%B0%80%EC%A7%80%EB%A7%8C-%ED%95%B4%EB%9D%BC">한 가지만 해라</a></p><ul><li><a href="#%ED%95%A8%EC%88%98-%EB%82%B4-%EC%84%B9%EC%85%98">함수 내 섹션</a></li></ul></li><li><p><a href="#%ED%95%A8%EC%88%98-%EB%8B%B9-%EC%B6%94%EC%83%81%ED%99%94-%EC%88%98%EC%A4%80%EC%9D%80-%ED%95%98%EB%82%98%EB%A1%9C">함수 당 추상화 수준은 하나로</a></p><ul><li><a href="#%EC%9C%84%EC%97%90%EC%84%9C-%EC%95%84%EB%9E%98%EB%A1%9C-%EC%BD%94%EB%93%9C-%EC%9D%BD%EA%B8%B0-%EB%82%B4%EB%A0%A4%EA%B0%80%EA%B8%B0-%EA%B7%9C%EC%B9%99">위에서 아래로 코드 읽기: 내려가기 규칙</a></li></ul></li><li><p><a href="#switch%EB%AC%B8">Switch문</a></p></li><li><p><a href="#%EC%84%9C%EC%88%A0%EC%A0%81%EC%9D%B8-%EC%9D%B4%EB%A6%84%EC%9D%84-%EC%82%AC%EC%9A%A9%ED%95%98%EB%9D%BC">서술적인 이름을 사용하라</a></p></li><li><p><a href="#%ED%95%A8%EC%88%98-%EC%9D%B8%EC%88%98">함수 인수</a></p><ul><li><a href="#%EB%A7%8E%EC%9D%B4-%EC%93%B0%EB%8A%94-%EB%8B%A8%ED%95%AD-%ED%98%95%EC%8B%9D">많이 쓰는 단항 형식</a></li><li><a href="#%ED%94%8C%EB%9E%98%EA%B7%B8flag-%EC%9D%B8%EC%88%98">플래그(flag) 인수</a></li><li><a href="#%EC%9D%B4%ED%95%AD-%ED%95%A8%EC%88%98">이항 함수</a></li><li><a href="#%EC%82%BC%ED%95%AD-%ED%95%A8%EC%88%98">삼항 함수</a></li><li><a href="#%EC%9D%B8%EC%88%98-%EA%B0%9D%EC%B2%B4">인수 객체</a></li><li><a href="#%EC%9D%B8%EC%88%98-%EB%AA%A9%EB%A1%9D">인수 목록</a></li><li><a href="#%EB%8F%99%EC%82%AC%EC%99%80-%ED%82%A4%EC%9B%8C%EB%93%9C">동사와 키워드</a></li></ul></li><li><p><a href="#%EB%B6%80%EC%88%98-%ED%9A%A8%EA%B3%BC%EB%A5%BC-%EC%9D%BC%EC%9C%BC%ED%82%A4%EC%A7%80-%EB%A7%88%EB%9D%BC">부수 효과를 일으키지 마라</a></p><ul><li><a href="#%EC%B6%9C%EB%A0%A5-%EC%9D%B8%EC%88%98">출력 인수</a></li></ul></li><li><p><a href="#%EB%AA%85%EB%A0%B9%EA%B3%BC-%EC%A1%B0%ED%9A%8C%EB%A5%BC-%EB%B6%84%EB%A6%AC%ED%95%98%EB%9D%BC">명령과 조회를 분리하라</a></p></li><li><p><a href="#%EC%98%A4%EB%A5%98-%EC%BD%94%EB%93%9C%EB%B3%B4%EB%8B%A4-%EC%98%88%EC%99%B8%EB%A5%BC-%EC%82%AC%EC%9A%A9%ED%95%98%EB%9D%BC">오류 코드보다 예외를 사용하라</a></p><ul><li><a href="#trycatch-%EB%B8%94%EB%A1%9D-%EB%BD%91%EC%95%84%EB%82%B4%EA%B8%B0">Try/Catch 블록 뽑아내기</a></li><li><a href="#%EC%98%A4%EB%A5%98-%EC%B2%98%EB%A6%AC%EB%8F%84-%ED%95%9C-%EA%B0%80%EC%A7%80-%EC%9E%91%EC%97%85%EC%9D%B4%EB%8B%A4">오류 처리도 한 가지 작업이다</a></li></ul></li><li><p><a href="#%EB%B0%98%EB%B3%B5%ED%95%98%EC%A7%80-%EB%A7%88%EB%9D%BC">반복하지 마라</a></p></li><li><p><a href="#%EA%B5%AC%EC%A1%B0%EC%A0%81-%ED%94%84%EB%A1%9C%EA%B7%B8%EB%9E%98%EB%B0%8D">구조적 프로그래밍</a></p></li><li><p><a href="#%ED%95%A8%EC%88%98%EB%A5%BC-%EC%96%B4%EB%96%BB%EA%B2%8C-%EC%A7%9C%EC%A3%A0">함수를 어떻게 짜죠?</a></p></li><li><p><a href="#%EA%B2%B0%EB%A1%A0">결론</a></p></li></ul></div>
        </main>
        <div class="closer"></div>
        <script
            defer
            src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.5.0/highlight.min.js"
        ></script>
        <script defer src="/Clean-Code/js/app.js"></script>
    </body>
</html>
